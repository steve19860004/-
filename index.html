function calculateAC() {
        // 1. è¨ˆç®—åªæ•¸
        let ping = 0;
        if (currentMode === 'dimensions') {
            const l = parseFloat(document.getElementById('length').value);
            const w = parseFloat(document.getElementById('width').value);
            if (!l || !w) return alert("è«‹è¼¸å…¥é•·å¯¬");
            ping = l * w * 0.3025;
        } else {
            ping = parseFloat(document.getElementById('pingInput').value);
            if (!ping) return alert("è«‹è¼¸å…¥åªæ•¸");
        }

        // 2. ç’°å¢ƒåŠ æˆèˆ‡ç´€éŒ„
        let reqKcal = ping * 500;
        let envText = [];
        if (document.getElementById('westSun').checked) { reqKcal *= 1.2; envText.push("è¥¿æ›¬"); }
        if (document.getElementById('topFloor').checked) { reqKcal *= 1.2; envText.push("é ‚æ¨“"); }
        if (document.getElementById('heatSource').checked) { reqKcal *= 1.1; envText.push("ç†±æº"); }
        if (envText.length === 0) envText.push("æ¨™æº–ç’°å¢ƒ");

        // 3. æ›ç®— kW èˆ‡åŒ¹é…å‹è™Ÿ
        const reqKW = reqKcal / 860;
        const standardSizes = [2.2, 2.8, 3.6, 4.1, 5.0, 6.3, 7.1, 8.0];
        let recSize = standardSizes.find(s => s >= reqKW);
        
        // 4. æ›´æ–°ç•«é¢
        document.getElementById('resPing').innerText = ping.toFixed(1);
        document.getElementById('resEnv').innerText = envText.join("ã€");
        
        let priceStr = "éœ€å°ˆäººå ±åƒ¹";
        let modelStr = "";

        if (recSize) {
            modelStr = `${recSize} kW`;
            // å–å¾—åƒ¹æ ¼å€é–“
            if (priceData[recSize]) {
                const p = priceData[recSize];
                const minP = p.min.toLocaleString();
                const maxP = p.max.toLocaleString();
                priceStr = `$${minP} ~ $${maxP}`;
            }
            
            // --- ä¿®æ­£é‡é»ï¼šä½¿ç”¨æ¨™æº–æœå°‹ç¶²å€ ---
            // encodeURIComponent ç”¨ä¾†ç¢ºä¿ä¸­æ–‡å­—å…ƒä¸æœƒè®“ç¶²å€å‡ºéŒ¯
            const keyword = encodeURIComponent(`${recSize}kwå†·æ°£`);
            const momoUrl = `https://www.momoshop.com.tw/search/searchShop.jsp?keyword=${keyword}`;
            
            document.getElementById('momoLink').href = momoUrl;
            document.getElementById('momoLink').style.display = "flex"; 
            
        } else {
            modelStr = `éœ€æ±‚ > 8.0 kW (å»ºè­°å•†ç”¨)`;
            document.getElementById('momoLink').style.display = "none"; 
        }

        document.getElementById('resModel').innerText = modelStr;
        document.getElementById('resPrice').innerText = priceStr;
        document.getElementById('result').style.display = 'block';

        // 5. æº–å‚™åˆ†äº«æ–‡å­—
        finalResultText = 
`ã€å†·æ°£è©•ä¼°å ±å‘Šã€‘
ğŸ  åªæ•¸ï¼š${ping.toFixed(1)} åª
â˜€ï¸ ç’°å¢ƒï¼š${envText.join("ã€")}
â„ï¸ å»ºè­°è¦æ ¼ï¼š${modelStr}
ğŸ’° é ç®—åƒè€ƒï¼š${priceStr}
(æ­¤ç‚ºç³»çµ±ä¼°ç®—ï¼Œåƒ…ä¾›åƒè€ƒ)`;
    }
