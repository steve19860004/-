<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 å“ç››å†·æ°£è¡Œ - å°ˆæ¥­è©•ä¼°ç³»çµ±</title>
    
    <link rel="icon" href="logo.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="logo.jpg">

    <style>
        :root {
            --primary-color: #0056b3;
            --primary-hover: #004494;
            --business-color: #20c997;
            --google-blue: #4285F4;
            --line-color: #06c755;
            --phone-color: #0dcaf0;
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-color: #333;
            --badge-red: #ff4757;
            --energy-yellow: #fff3cd;
            --saving-green: #d4edda;
        }

        body {
            font-family: "Microsoft JhengHei", "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            padding-bottom: 100px;
            color: var(--text-color);
            flex-direction: column;
        }

        .container {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 550px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .new-badge {
            position: absolute;
            top: 15px;
            right: -30px;
            background: var(--badge-red);
            color: white;
            padding: 5px 30px;
            transform: rotate(45deg);
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .brand-logo { display: block; width: 80px; height: auto; margin: 0 auto 10px auto; }
        h1 { text-align: center; color: var(--primary-color); margin-bottom: 0.5rem; font-size: 1.8rem; font-weight: 800; }
        .subtitle { text-align: center; color: #555; font-size: 1rem; margin-bottom: 0.5rem; font-weight: bold; }
        .desc-text { text-align: center; color: #777; font-size: 0.9rem; margin-bottom: 1.5rem; line-height: 1.5; background: #f8f9fa; padding: 10px; border-radius: 8px; }

        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #eee; }
        .tab-btn {
            flex: 1; padding: 12px; border: none; background: none; cursor: pointer;
            font-size: 16px; font-weight: bold; color: #888;
            border-bottom: 3px solid transparent; transition: all 0.3s;
        }
        .tab-btn.active { color: var(--primary-color); border-bottom: 3px solid var(--primary-color); }

        .input-section { display: none; animation: fadeIn 0.5s; }
        .input-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        .input-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        input[type="number"], select, input[type="range"] {
            width: 100%; padding: 12px; border: 1px solid #ddd;
            border-radius: 8px; font-size: 16px; box-sizing: border-box; background: #fff;
        }

        .range-container { display: flex; align-items: center; gap: 10px; }
        .range-value { min-width: 60px; text-align: right; font-weight: bold; color: var(--primary-color); }

        optgroup[label="ğŸ­ å•†ç”¨ç©ºé–“"] { color: var(--business-color); font-weight: bold; }

        .checkbox-group {
            background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;
            display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
        }
        .checkbox-item { display: flex; align-items: center; cursor: pointer; font-size: 0.95rem;}
        .checkbox-item input { margin-right: 8px; width: 18px; height: 18px; cursor: pointer; }

        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        button.calc-btn {
            flex: 2; padding: 14px; background-color: var(--primary-color); color: white; border: none; border-radius: 8px;
            font-size: 18px; font-weight: bold; cursor: pointer; transition: background 0.3s; transform: scale(1);
        }
        button.calc-btn:hover { background-color: var(--primary-hover); }
        button.calc-btn:active { transform: scale(0.98); }
        button.reset-btn { flex: 1; padding: 14px; background-color: #e2e6ea; color: #495057; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }

        #result { margin-top: 25px; display: none; border-top: 1px solid #eee; padding-top: 20px; }
        
        .rec-card {
            background: #fff; border: 2px solid var(--primary-color); border-radius: 8px; padding: 20px; text-align: center; margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .rec-value { font-size: 1.8rem; font-weight: 800; color: var(--primary-color); }
        .rec-sub { font-size: 0.9rem; color: #666; margin-top: 5px; }
        .type-badge { background: #e9ecef; color: #555; padding: 4px 10px; border-radius: 20px; font-size: 0.85rem; margin-top: 8px; display: inline-block; }

        .energy-box { background: var(--energy-yellow); border: 1px solid #ffeeba; color: #856404; padding: 15px; border-radius: 8px; margin-top: 15px; font-size: 0.9rem; text-align: left; }
        .energy-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .saving-highlight { background-color: var(--saving-green); color: #155724; padding: 5px 10px; border-radius: 5px; margin-top: 10px; text-align: center; font-weight: bold; border: 1px solid #c3e6cb; }

        /* æ–½å·¥è²»ç”¨å€ */
        .fee-section { margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 15px; display: none; }
        .fee-title { font-weight: bold; color: #555; margin-bottom: 10px; text-align: center; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;}
        .fee-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; margin-bottom: 10px; }
        .fee-table td { padding: 8px; border-bottom: 1px solid #eee; }
        .fee-table td:last-child { text-align: right; font-weight: bold; color: #333; }
        .fee-note { font-size: 0.8rem; color: #999; text-align: center; }

        /* FAQ å€å¡Š */
        .faq-section { margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px; }
        .faq-header { font-size: 1.2rem; font-weight: bold; text-align: center; color: var(--primary-color); margin-bottom: 15px; }
        .faq-item { background: #f8f9fa; margin-bottom: 10px; border-radius: 8px; overflow: hidden; }
        .faq-question { 
            padding: 15px; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; align-items: center;
            color: #444; transition: background 0.2s;
        }
        .faq-question:hover { background: #e9ecef; }
        .faq-answer { 
            padding: 0 15px; max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; background: #fff; color: #666; font-size: 0.95rem; line-height: 1.6;
        }
        .faq-answer.open { padding: 15px; max-height: 200px; border-top: 1px solid #eee; }
        .arrow { transition: transform 0.3s; }
        .faq-question.active .arrow { transform: rotate(180deg); }

        /* åœ°åœ–å€å¡Š */
        .map-section { margin-top: 30px; margin-bottom: 20px; }
        .map-frame { width: 100%; height: 250px; border: 0; border-radius: 12px; }

        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .action-btn { padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: white; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; font-size: 0.95rem; }
        .google-btn { background-color: var(--google-blue); grid-column: span 2; font-size: 1.1rem; padding: 14px; }
        .line-btn { background-color: var(--line-color); }
        .copy-btn { background-color: #6c757d; }
        .action-btn:hover { opacity: 0.9; }

        .footer { text-align: center; font-size: 0.85rem; color: #888; margin-top: 10px; line-height: 1.6; }
        .footer span { font-weight: bold; color: var(--primary-color); }

        /* æ‡¸æµ®æŒ‰éˆ• */
        .float-group { position: fixed; bottom: 20px; right: 20px; z-index: 100; display: flex; flex-direction: column; gap: 10px; align-items: flex-end; }
        .float-btn {
            background-color: var(--line-color); color: white; padding: 12px 20px; border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); font-weight: bold; text-decoration: none;
            display: flex; align-items: center; gap: 8px; transition: transform 0.2s;
        }
        .float-btn.phone { background-color: var(--phone-color); color: #fff; }
        .float-btn:hover { transform: scale(1.05); }
        .float-btn:active { transform: scale(0.95); }
    </style>
</head>
<body>

<div class="float-group">
    <a href="tel:0912132100" class="float-btn phone">ğŸ“ æ’¥æ‰“é›»è©±</a>
    <a href="https://line.me/R/ti/p/@bah4568u" target="_blank" class="float-btn">ğŸ’¬ LINE é ç´„</a>
</div>

<div class="container">
    <div class="new-badge">2026 æœ€æ–°</div>
    <img src="logo.jpg" alt="å“ç››å†·æ°£è¡Œ" class="brand-logo" onerror="this.style.display='none'">
    
    <h1>â„ï¸ å“ç››å†·æ°£è¡Œ</h1>
    <div class="subtitle">å†·æ°£å¤§å°å°ˆæ¥­è©•ä¼°å™¨</div>
    <div class="desc-text">
        âœ¨ è¼¸å…¥åªæ•¸ç®—å™¸æ•¸ï¼ŒGoogle å¹«ä½ æŸ¥åƒ¹æ ¼<br>
        ğŸ’° <b>é€æ˜ï¼š</b>å«é›»è²»ä¼°ç®—èˆ‡æ–½å·¥è¡Œæƒ…
    </div>
    
    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('dimensions')">è¼¸å…¥é•·å¯¬</button>
        <button class="tab-btn" onclick="switchTab('area')">ç›´æ¥è¼¸å…¥åªæ•¸</button>
    </div>

    <div class="input-group">
        <label>1. ç©ºé–“é¡å‹</label>
        <select id="roomType">
            <optgroup label="ğŸ  å±…å®¶ç©ºé–“">
                <option value="450">è‡¥å®¤ (450 kcal)</option>
                <option value="500" selected>å®¢å»³/æ¨™æº– (500 kcal)</option>
                <option value="600">é ‚æ¨“/è¥¿æ›¬æˆ¿ (600 kcal)</option>
            </optgroup>
            <optgroup label="ğŸ­ å•†ç”¨ç©ºé–“">
                <option value="700">ä¸€èˆ¬è¾¦å…¬å®¤/åº—é¢ (700 kcal)</option>
                <option value="800">é£²æ–™åº—/äººå¤šå ´æ‰€ (800 kcal)</option>
                <option value="1000">ç«é‹åº—/ç‡’çƒ¤/æ©Ÿæˆ¿ (1000 kcal)</option>
            </optgroup>
        </select>
    </div>

    <div id="input-dimensions" class="input-section active">
        <div class="input-group">
            <label>2. æˆ¿é–“å°ºå¯¸</label>
            <div style="display: flex; gap: 10px;">
                <input type="number" id="length" placeholder="é•· (å…¬å°º)">
                <input type="number" id="width" placeholder="å¯¬ (å…¬å°º)">
            </div>
        </div>
    </div>

    <div id="input-area" class="input-section">
        <div class="input-group">
            <label>2. æˆ¿é–“åªæ•¸</label> 
            <input type="number" id="pingInput" placeholder="ä¾‹å¦‚ï¼š6.5">
        </div>
    </div>

    <div class="input-group">
        <label>3. æ¨“é«˜èˆ‡ä½¿ç”¨ç¿’æ…£</label>
        <div style="margin-bottom: 10px;">
            <span style="font-size:0.9rem; color:#666;">å¤©èŠ±æ¿é«˜åº¦ (å…¬å°º)</span>
            <input type="number" id="ceilingHeight" placeholder="æ¨™æº–ç‚º 3.0" value="3.0" step="0.1" style="margin-top:5px;">
        </div>
        <div>
            <span style="font-size:0.9rem; color:#666;">é è¨ˆæ¯å¤©é–‹æ©Ÿ (å°æ™‚)</span>
            <div class="range-container">
                <input type="range" id="usageHours" min="1" max="24" value="8" oninput="updateRangeVal(this.value)">
                <span class="range-value" id="hoursDisplay">8 å°æ™‚</span>
            </div>
        </div>
    </div>

    <div class="checkbox-group">
        <label class="checkbox-item"><input type="checkbox" id="westSun"> è¥¿æ›¬ (+20%)</label>
        <label class="checkbox-item"><input type="checkbox" id="topFloor"> ä½é ‚æ¨“ (+20%)</label>
        <label class="checkbox-item"><input type="checkbox" id="glassWall"> ç»ç’ƒå¸·å¹• (+15%)</label>
        <label class="checkbox-item"><input type="checkbox" id="crowded"> äººæ½®æ“æ“  (+10%)</label>
    </div>

    <div class="btn-row">
        <button class="reset-btn" onclick="resetForm()">æ¸…é™¤é‡å¡«</button>
        <button class="calc-btn" onclick="calculateAC()">é–‹å§‹è©•ä¼°</button>
    </div>

    <div id="result">
        <div class="rec-card">
            <div style="font-size:0.9rem; color:#666;">å»ºè­°å®‰è£è¦æ ¼</div>
            <div class="rec-value" id="resModel">è¨ˆç®—ä¸­...</div>
            <div class="rec-sub"><span id="resBTU">0</span> BTU / ç´„ <span id="resTon">0</span> å™¸</div>
            <div id="resUnitType" class="type-badge">å»ºè­°æ©Ÿå‹ï¼šå£æ›å¼</div>
            
            <div class="energy-box">
                <div style="text-align:center; font-weight:bold; margin-bottom:8px; color:#856404;">âš¡ æ–°èˆŠå†·æ°£é›»è²»å°æ±º</div>
                <div class="energy-row"><span>èˆŠå‹å®šé »é›»è²»ï¼š</span><span style="text-decoration: line-through; color:#999;">$ <span id="costOld">0</span> /æœˆ</span></div>
                <div class="energy-row"><span style="font-weight:bold; color:#000;">ä¸€ç´šè®Šé »é›»è²»ï¼š</span><span style="font-weight:bold; color:#d0021b;">$ <span id="costNew">0</span> /æœˆ</span></div>
                <div class="saving-highlight">æ›æ–°å†·æ°£ï¼Œæ¯æœˆçœä¸‹ç´„ $ <span id="saveAmount">0</span> å…ƒï¼</div>
            </div>

            <div style="margin-top:20px; text-align:center;">
                <button onclick="toggleFees()" style="background:none; border:none; color:#0056b3; text-decoration:underline; cursor:pointer; font-size:0.9rem;">ğŸ“‹ æŸ¥çœ‹é¡å¤–æ–½å·¥åƒè€ƒè¡Œæƒ…</button>
                <div id="feeSection" class="fee-section">
                    <div class="fee-title">ğŸ”§ ç‰¹æ®Šæ–½å·¥è¡Œæƒ…åƒè€ƒ</div>
                    <table class="fee-table" id="feeTable"></table>
                    <div class="fee-note">*ä»¥ä¸Šç‚ºé€£å·¥å¸¶æ–™åƒè€ƒåƒ¹ï¼Œå¯¦éš›ä¾ç¾å ´ç’°å¢ƒå ±åƒ¹ç‚ºæº–ã€‚</div>
                </div>
            </div>

            <div style="margin-top: 15px; font-size: 0.9rem; color: #555;">
                ç¸½ç†±è² è¼‰ï¼š<span id="resTotalKcal" style="font-weight:bold;">0</span> kcal/h<br>æ©Ÿå‹åƒ¹æ ¼ï¼š<span id="resPrice">--</span>
            </div>
        </div>

        <div class="action-buttons">
            <a href="#" target="_blank" id="searchLink" class="action-btn google-btn">ğŸ” Google å“ç‰Œè²»ç”¨æŸ¥è©¢</a>
            <button onclick="shareToLine()" class="action-btn line-btn">LINE åˆ†äº«</button>
            <button onclick="copyToClipboard()" class="action-btn copy-btn">è¤‡è£½çµæœ</button>
        </div>
    </div>

    <div class="faq-section">
        <div class="faq-header">â“ å¸¸è¦‹å•é¡Œ</div>
        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">ç¾å ´å ´å‹˜éœ€è¦è²»ç”¨å—ï¼Ÿ<span class="arrow">â–¼</span></div>
            <div class="faq-answer">æˆ‘å€‘æä¾›å…è²»çš„åˆæ­¥ç·šä¸Šè«®è©¢ï¼è‹¥éœ€è¦å¸«å‚…ç¾å ´å ´å‹˜è¦åŠƒï¼Œæ­¡è¿åŠ  LINE é ç´„ï¼Œæˆäº¤å¯æŠ˜æŠµå ´å‹˜è²»ã€‚</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">å®‰è£æœ‰ä¿å›ºå—ï¼Ÿ<span class="arrow">â–¼</span></div>
            <div class="faq-answer">æœ‰çš„ï¼å“ç››å†·æ°£è¡Œå®‰è£çš„å†·æ°£çš†äº«åŸå» ä¿å›ºï¼Œæ–½å·¥éƒ¨åˆ†æˆ‘å€‘ä¹Ÿæä¾›å®‰å¿ƒä¿å›ºï¼Œè®“æ‚¨ä½¿ç”¨ç„¡å¾Œé¡§ä¹‹æ†‚ã€‚</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">å¯ä»¥é…åˆè£æ½¢é€²å ´æ™‚é–“å—ï¼Ÿ<span class="arrow">â–¼</span></div>
            <div class="faq-answer">æ²’å•é¡Œï¼æˆ‘å€‘æœ‰è±å¯Œçš„é…åˆè£æ½¢ç¶“é©—ï¼Œå¯é…åˆè¨­è¨ˆå¸«é€²è¡Œå…©æ¬¡æ–½å·¥ï¼ˆæ‹‰ç®¡+æ›æ©Ÿï¼‰ï¼Œç¢ºä¿ç¾è§€ã€‚</div>
        </div>
    </div>

    <div class="map-section">
        <div class="faq-header">ğŸ“ é–€å¸‚ä½ç½®</div>
        <iframe class="map-frame" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.7036493264513!2d121.56627631500643!3d25.03396388397232!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442abb6da9c9e1f%3A0x1206b5370d909a75!2z5Y-w5YyXMTAx!5e0!3m2!1szh-TW!2stw!4v1626244799059!5m2!1szh-TW!2stw" allowfullscreen="" loading="lazy"></iframe>
        <div style="text-align:center; margin-top:10px; font-size:0.9rem;">
            <div>é›»è©±ï¼š0912-132-100</div>
            <div>æ­¡è¿ä¾†åº—è«®è©¢ï¼Œè«‹å…ˆé ç´„</div>
        </div>
    </div>

</div>

<div class="footer">
    &copy; 2026 <span>å“ç››å†·æ°£è¡Œ</span> ç‰ˆæ¬Šæ‰€æœ‰<br>
    å°ˆæ¥­å†·æ°£è¦åŠƒãƒ»å®‰è£ãƒ»ç¶­ä¿®ãƒ»ä¿é¤Šé¦–é¸
</div>

<script>
    // JS Logic
    const priceData = { 2.2: { min: 14000, max: 22000 }, 2.8: { min: 18000, max: 28000 }, 3.6: { min: 25000, max: 35000 }, 4.1: { min: 29000, max: 40000 }, 5.0: { min: 35000, max: 48000 }, 6.3: { min: 42000, max: 58000 }, 7.1: { min: 50000, max: 65000 }, 8.0: { min: 58000, max: 75000 }, 10.0: { min: 70000, max: 90000 }, 12.0: { min: 85000, max: 110000 }, 14.0: { min: 100000, max: 130000 } };
    const installFees = [ { item: "å®¤å¤–æ©Ÿè±ªè¯Aæ¶", price: "$1,500 èµ·" }, { item: "ç‰†é¢æ´—å­” (1å­”)", price: "$800 ~ $1,200" }, { item: "å†·åª’ç®¡å»¶é•· (æ¯ç±³)", price: "$400 ~ $500" }, { item: "é›»æºç·šå»¶é•· (æ¯ç±³)", price: "$100 ~ $150" }, { item: "æ’æ°´å™¨å®‰è£", price: "$1,500 èµ·" }, { item: "æ‹†é™¤èˆŠæ©Ÿ (å›æ”¶å…)", price: "$500 ~ $1,000" } ];
    let currentMode = 'dimensions'; let finalResultText = "";

    function switchTab(mode) { currentMode = mode; document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); event.target.classList.add('active'); document.querySelectorAll('.input-section').forEach(s => s.classList.remove('active')); document.getElementById(mode === 'dimensions' ? 'input-dimensions' : 'input-area').classList.add('active'); document.getElementById('result').style.display = 'none'; }
    function updateRangeVal(val) { document.getElementById('hoursDisplay').innerText = val + " å°æ™‚"; }
    
    function toggleFees() {
        const feeSec = document.getElementById('feeSection');
        if (feeSec.style.display === 'block') { feeSec.style.display = 'none'; } else {
            const table = document.getElementById('feeTable'); table.innerHTML = "";
            installFees.forEach(f => { table.innerHTML += `<tr><td>${f.item}</td><td>${f.price}</td></tr>`; });
            feeSec.style.display = 'block';
        }
    }
    
    function toggleFaq(element) {
        element.classList.toggle('active');
        const answer = element.nextElementSibling;
        answer.classList.toggle('open');
    }

    function resetForm() {
        document.getElementById('length').value = ''; document.getElementById('width').value = ''; document.getElementById('pingInput').value = ''; document.getElementById('ceilingHeight').value = '3.0'; document.getElementById('usageHours').value = '8'; updateRangeVal(8);
        document.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false); document.getElementById('roomType').selectedIndex = 1; document.getElementById('result').style.display = 'none'; document.getElementById('feeSection').style.display = 'none';
    }

    function calculateAC() {
        let ping = 0;
        if (currentMode === 'dimensions') {
            const l = parseFloat(document.getElementById('length').value); const w = parseFloat(document.getElementById('width').value);
            if (!l || !w) return alert("è«‹è¼¸å…¥é•·åº¦èˆ‡å¯¬åº¦"); ping = l * w * 0.3025;
        } else { ping = parseFloat(document.getElementById('pingInput').value); if (!ping) return alert("è«‹è¼¸å…¥åªæ•¸"); }

        const baseKcal = parseInt(document.getElementById('roomType').value); let reqKcal = ping * baseKcal;
        let envText = [];
        if (document.getElementById('westSun').checked) { reqKcal *= 1.2; envText.push("è¥¿æ›¬"); }
        if (document.getElementById('topFloor').checked) { reqKcal *= 1.2; envText.push("é ‚æ¨“"); }
        if (document.getElementById('glassWall').checked) { reqKcal *= 1.15; envText.push("ç»ç’ƒå¸·å¹•"); }
        if (document.getElementById('crowded').checked) { reqKcal *= 1.1; envText.push("äººæ½®å¤š"); }

        const height = parseFloat(document.getElementById('ceilingHeight').value) || 3.0;
        if (height > 3.0) { reqKcal *= (height / 3.0); envText.push(`æŒ‘é«˜${height}m`); }

        const reqKW = reqKcal / 860;
        const standardSizes = [2.2, 2.8, 3.6, 4.1, 5.0, 6.3, 7.1, 8.0, 10.0, 12.0, 14.0];
        let recSize = standardSizes.find(s => s >= reqKW);
        
        const hours = parseInt(document.getElementById('usageHours').value);
        let costNew = 0, costOld = 0, saveAmount = 0;
        if (recSize) {
            costNew = (recSize / 5.0) * hours * 30 * 4.5;
            costOld = (recSize / 2.8) * hours * 30 * 4.5;
            saveAmount = costOld - costNew;
        }

        const roomTypeSelect = document.getElementById('roomType');
        const roomTypeName = roomTypeSelect.options[roomTypeSelect.selectedIndex].text.split('(')[0];
        const isCommercial = baseKcal >= 700; 

        document.getElementById('resTotalKcal').innerText = Math.round(reqKcal);
        document.getElementById('costNew').innerText = Math.round(costNew).toLocaleString();
        document.getElementById('costOld').innerText = Math.round(costOld).toLocaleString();
        document.getElementById('saveAmount').innerText = Math.round(saveAmount).toLocaleString();

        let modelStr = "", priceStr = "éœ€å°ˆæ¡ˆå ±åƒ¹", unitTypeStr = "å»ºè­°æ©Ÿå‹ï¼šå£æ›å¼", searchKeyword = "", btuStr = "0", tonStr = "0";

        if (recSize) {
            modelStr = `${recSize} kW`; btuStr = Math.round(recSize * 3412).toLocaleString(); tonStr = (recSize / 2.8).toFixed(1);
            if (isCommercial) {
                if (recSize >= 8.0) { unitTypeStr = "å»ºè­°æ©Ÿå‹ï¼šç®±å‹(è½åœ°) æˆ– åŠéš±å¼"; searchKeyword = `${recSize}kw å•†ç”¨å†·æ°£ åƒ¹æ ¼`; }
                else { unitTypeStr = "å»ºè­°æ©Ÿå‹ï¼šå››æ–¹å¹(åµŒå…¥) æˆ– åŠéš±å¼"; searchKeyword = `${recSize}kw åµŒå…¥å¼å†·æ°£ åƒ¹æ ¼`; }
            } else { searchKeyword = `${recSize}kw å†·æ°£ åƒ¹æ ¼`; }

            if (priceData[recSize]) { const p = priceData[recSize]; priceStr = `$${p.min.toLocaleString()} ~ $${p.max.toLocaleString()}`; }
            
            const googleUrl = `https://www.google.com/search?q=${encodeURIComponent(searchKeyword)}`;
            document.getElementById('searchLink').href = googleUrl; document.getElementById('searchLink').style.display = "flex";
        } else {
            modelStr = `éœ€æ±‚ > 14 kW`; unitTypeStr = "å»ºè­°ä½¿ç”¨ï¼šVRVå¤šè¯è®Šé »ç³»çµ±"; document.getElementById('searchLink').style.display = "none";
        }

        document.getElementById('resModel').innerText = modelStr; document.getElementById('resBTU').innerText = btuStr; document.getElementById('resTon').innerText = tonStr;
        document.getElementById('resUnitType').innerText = unitTypeStr; document.getElementById('resPrice').innerText = priceStr;
        document.getElementById('result').style.display = 'block';

        finalResultText = `ã€å“ç››å†·æ°£è¡Œï½œ2026 å°ˆæ¥­è©•ä¼°ã€‘\nğŸ  å ´åŸŸï¼š${roomTypeName}\nğŸ“ åªæ•¸ï¼š${ping.toFixed(1)} åª\nâ„ï¸ å»ºè­°ï¼š${modelStr} (ç´„${tonStr}å™¸)\nğŸ”¥ æ¯”è¼ƒï¼šæ›æ–°æ©Ÿæ¯æœˆç´„çœ $${Math.round(saveAmount)}\nğŸ’° æ©Ÿå‹åƒ¹æ ¼ï¼š${priceStr}\n(ç³»çµ±ä¼°ç®—ï¼Œåƒ…ä¾›åƒè€ƒ)`;
    }

    function copyToClipboard() { if (!finalResultText) return; navigator.clipboard.writeText(finalResultText).then(() => alert("âœ… çµæœå·²è¤‡è£½ï¼")); }
    function shareToLine() { if (!finalResultText) return; window.open(`https://line.me/R/msg/text/?${encodeURIComponent(finalResultText)}`, '_blank'); }
</script>

</body>
</html>