<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨èƒ½å†·æ°£è©•ä¼°ç³»çµ± (å°ˆæ¥­ç‰ˆ)</title>
    <style>
        :root {
            --primary-color: #007bff;
            --primary-hover: #0056b3;
            --momo-color: #d0021b;
            --line-color: #06c755;
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #333;
            --highlight-orange: #fd7e14;
        }

        body {
            font-family: "Microsoft JhengHei", "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
        }

        .container {
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 500px;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.6rem;
        }

        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #eee; }
        .tab-btn {
            flex: 1; padding: 12px; border: none; background: none;
            cursor: pointer; font-size: 16px; font-weight: bold; color: #888;
            border-bottom: 3px solid transparent; transition: all 0.3s;
        }
        .tab-btn.active { color: var(--primary-color); border-bottom: 3px solid var(--primary-color); }

        .input-section { display: none; animation: fadeIn 0.5s; }
        .input-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        .input-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        input[type="number"], select {
            width: 100%; padding: 12px; border: 1px solid #ddd;
            border-radius: 8px; font-size: 16px; box-sizing: border-box; background: #fff;
        }

        .checkbox-group {
            background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 15px;
        }
        .checkbox-item { display: flex; align-items: center; margin-bottom: 8px; cursor: pointer; }
        .checkbox-item input { margin-right: 10px; width: 18px; height: 18px; }

        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        
        button.calc-btn {
            flex: 2; padding: 14px; background-color: var(--primary-color);
            color: white; border: none; border-radius: 8px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            transition: background 0.3s;
        }
        button.calc-btn:hover { background-color: var(--primary-hover); }

        button.reset-btn {
            flex: 1; padding: 14px; background-color: #e2e6ea;
            color: #495057; border: none; border-radius: 8px;
            font-size: 16px; font-weight: bold; cursor: pointer;
        }
        button.reset-btn:hover { background-color: #dbe2e8; }

        #result { margin-top: 25px; display: none; border-top: 1px solid #eee; padding-top: 20px; }
        
        .result-card {
            background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 10px;
        }
        
        .rec-card {
            background: #fff; border: 2px solid var(--primary-color);
            border-radius: 8px; padding: 15px; text-align: center; margin-bottom: 15px;
            position: relative; overflow: hidden;
        }
        .rec-title { font-size: 0.9rem; color: #666; margin-bottom: 5px; }
        .rec-value { font-size: 1.5rem; font-weight: bold; color: var(--primary-color); }
        
        .price-box {
            background: #fff0f1; border: 1px solid #ffcdd2;
            padding: 10px; border-radius: 6px; margin-top: 10px;
            color: #c62828; font-weight: bold;
        }

        /* 2. è£œåŠ©é‡‘æ¨™ç±¤ */
        .rebate-tag {
            background-color: var(--highlight-orange); color: white;
            font-size: 0.8rem; padding: 4px 8px; border-radius: 4px;
            display: inline-block; margin-top: 5px;
        }

        .action-buttons {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;
        }
        .action-btn {
            padding: 10px; border: none; border-radius: 6px; cursor: pointer;
            font-weight: bold; color: white; display: flex; align-items: center; justify-content: center; gap: 5px; text-decoration: none; font-size: 0.9rem;
        }
        .momo-btn { background-color: var(--momo-color); grid-column: span 2; font-size: 1.1rem; padding: 12px; }
        .line-btn { background-color: var(--line-color); }
        .copy-btn { background-color: #6c757d; }

        .note { font-size: 0.8rem; color: #999; margin-top: 20px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h1>â„ï¸ å…¨èƒ½å†·æ°£è©•ä¼°å¸«</h1>
    
    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('dimensions')">è¼¸å…¥é•·å¯¬</button>
        <button class="tab-btn" onclick="switchTab('area')">ç›´æ¥è¼¸å…¥åªæ•¸</button>
    </div>

    <div class="input-group">
        <label>ç©ºé–“é¡å‹ (å½±éŸ¿æ‰€éœ€å†·åº¦)</label>
        <select id="roomType">
            <option value="450">è‡¥å®¤/ä¸€èˆ¬æˆ¿é–“ (450 kcal/åª)</option>
            <option value="500" selected>æ¨™æº–/æ›¸æˆ¿ (500 kcal/åª)</option>
            <option value="600">å®¢å»³/é–‹æ”¾å¼ç©ºé–“ (600 kcal/åª)</option>
        </select>
    </div>

    <div id="input-dimensions" class="input-section active">
        <div class="input-group">
            <label>é•·åº¦ (å…¬å°º)</label> <input type="number" id="length" placeholder="ä¾‹å¦‚ï¼š5.0">
        </div>
        <div class="input-group">
            <label>å¯¬åº¦ (å…¬å°º)</label> <input type="number" id="width" placeholder="ä¾‹å¦‚ï¼š4.0">
        </div>
    </div>

    <div id="input-area" class="input-section">
        <div class="input-group">
            <label>æˆ¿é–“åªæ•¸</label> <input type="number" id="pingInput" placeholder="ä¾‹å¦‚ï¼š6.5">
        </div>
    </div>

    <div class="checkbox-group">
        <label class="checkbox-item"><input type="checkbox" id="westSun"> æœ‰è¥¿æ›¬ (+20%)</label>
        <label class="checkbox-item"><input type="checkbox" id="topFloor"> ä½é ‚æ¨“ (+20%)</label>
        <label class="checkbox-item"><input type="checkbox" id="heatSource"> æŒ‘é«˜/ç†±æºå¤š (+10%)</label>
    </div>

    <div class="btn-row">
        <button class="reset-btn" onclick="resetForm()">æ¸…é™¤</button>
        <button class="calc-btn" onclick="calculateAC()">é–‹å§‹è¨ˆç®—</button>
    </div>

    <div id="result">
        <div class="result-card">
            <div>ç©ºé–“ï¼š<span id="resPing">0</span> åª / <span id="resRoomType">æ¨™æº–</span></div>
            <div>ç’°å¢ƒåŠ æˆï¼š<span id="resEnv">ç„¡</span></div>
        </div>

        <div class="rec-card">
            <div class="rec-title">å»ºè­°å®‰è£è¦æ ¼</div>
            <div class="rec-value" id="resModel">è¨ˆç®—ä¸­...</div>
            
            <div id="rebateInfo" class="rebate-tag" style="display:none;"></div>

            <div class="price-box">
                é ä¼°é ç®—ï¼š<span id="resPrice">--</span>
            </div>
        </div>

        <div class="action-buttons">
            <a href="#" target="_blank" id="momoLink" class="action-btn momo-btn">
                ğŸ›ï¸ å‰å¾€ Momo æ¯”åƒ¹è³¼è²·
            </a>
            <button onclick="shareToLine()" class="action-btn line-btn">LINE åˆ†äº«</button>
            <button onclick="copyToClipboard()" class="action-btn copy-btn">è¤‡è£½çµæœ</button>
        </div>
    </div>

    <div class="note">
        * è£œåŠ©é‡‘ä¾æ”¿åºœå…¬å‘Šç‚ºæº– (è²¨ç‰©ç¨…æ¸›å…)ã€‚<br>
        * åƒ¹æ ¼åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›ä¾å“ç‰Œèˆ‡æ´»å‹•è€Œå®šã€‚
    </div>
</div>

<script>
    const priceData = {
        2.2: { min: 14000, max: 22000 },
        2.8: { min: 17000, max: 26000 },
        3.6: { min: 22000, max: 32000 },
        4.1: { min: 26000, max: 38000 },
        5.0: { min: 32000, max: 45000 },
        6.3: { min: 40000, max: 55000 },
        7.1: { min: 48000, max: 62000 },
        8.0: { min: 55000, max: 70000 }
    };

    let currentMode = 'dimensions';
    let finalResultText = "";

    function switchTab(mode) {
        currentMode = mode;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        document.querySelectorAll('.input-section').forEach(s => s.classList.remove('active'));
        document.getElementById(mode === 'dimensions' ? 'input-dimensions' : 'input-area').classList.add('active');
        document.getElementById('result').style.display = 'none';
    }

    // æ¸…é™¤é‡å¡«åŠŸèƒ½
    function resetForm() {
        document.getElementById('length').value = '';
        document.getElementById('width').value = '';
        document.getElementById('pingInput').value = '';
        document.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);
        document.getElementById('roomType').value = '500'; // å›å¾©é è¨­
        document.getElementById('result').style.display = 'none';
    }

    function calculateAC() {
        // 1. è¨ˆç®—åªæ•¸
        let ping = 0;
        if (currentMode === 'dimensions') {
            const l = parseFloat(document.getElementById('length').value);
            const w = parseFloat(document.getElementById('width').value);
            if (!l || !w) return alert("è«‹è¼¸å…¥é•·å¯¬");
            ping = l * w * 0.3025;
        } else {
            ping = parseFloat(document.getElementById('pingInput').value);
            if (!ping) return alert("è«‹è¼¸å…¥åªæ•¸");
        }

        // 2. å–å¾—åŸºç¤å†·åº¦ (ç©ºé–“é¡å‹)
        const baseKcal = parseInt(document.getElementById('roomType').value);
        let reqKcal = ping * baseKcal;

        // 3. ç’°å¢ƒåŠ æˆ
        let envText = [];
        if (document.getElementById('westSun').checked) { reqKcal *= 1.2; envText.push("è¥¿æ›¬"); }
        if (document.getElementById('topFloor').checked) { reqKcal *= 1.2; envText.push("é ‚æ¨“"); }
        if (document.getElementById('heatSource').checked) { reqKcal *= 1.1; envText.push("æŒ‘é«˜/ç†±æº"); }
        if (envText.length === 0) envText.push("æ¨™æº–ç’°å¢ƒ");

        // 4. æ›ç®—èˆ‡åŒ¹é…
        const reqKW = reqKcal / 860;
        const standardSizes = [2.2, 2.8, 3.6, 4.1, 5.0, 6.3, 7.1, 8.0];
        let recSize = standardSizes.find(s => s >= reqKW);
        
        // 5. æ›´æ–°ç•«é¢è³‡è¨Š
        const roomTypeSelect = document.getElementById('roomType');
        const roomTypeName = roomTypeSelect.options[roomTypeSelect.selectedIndex].text.split('(')[0];
        
        document.getElementById('resPing').innerText = ping.toFixed(1);
        document.getElementById('resRoomType').innerText = roomTypeName;
        document.getElementById('resEnv').innerText = envText.join("ã€");
        
        let priceStr = "éœ€å°ˆäººå ±åƒ¹";
        let modelStr = "";
        let rebateStr = "";

        if (recSize) {
            modelStr = `${recSize} kW`;
            
            // åƒ¹æ ¼
            if (priceData[recSize]) {
                const p = priceData[recSize];
                priceStr = `$${p.min.toLocaleString()} ~ $${p.max.toLocaleString()}`;
            }

            // --- è²¨ç‰©ç¨…é€€ç¨…è¨ˆç®— (ä¼°ç®—å€¼) ---
            // 3.6kW ä»¥ä¸‹ç´„é€€ 1600, ä»¥ä¸Šç´„é€€ 2000 (ç°¡åŒ–è¦å‰‡)
            const rebateAmount = recSize < 3.6 ? 1600 : 2000;
            rebateStr = `ğŸ”¥ æ”¿åºœç¯€èƒ½è£œåŠ©ï¼šå¯é€€ç¨…ç´„ $${rebateAmount}`;
            const rebateEl = document.getElementById('rebateInfo');
            rebateEl.innerText = rebateStr;
            rebateEl.style.display = 'inline-block';

            // Momo é€£çµ
            const keyword = encodeURIComponent(`${recSize}kwå†·æ°£ ä¸€ç´šè®Šé »`); // åŠ å¼·é—œéµå­—
            const momoUrl = `https://www.momoshop.com.tw/search/searchShop.jsp?keyword=${keyword}`;
            document.getElementById('momoLink').href = momoUrl;
            document.getElementById('momoLink').style.display = "flex";
            
        } else {
            modelStr = `éœ€æ±‚ > 8.0 kW (å»ºè­°å•†ç”¨)`;
            document.getElementById('momoLink').style.display = "none";
            document.getElementById('rebateInfo').style.display = 'none';
        }

        document.getElementById('resModel').innerText = modelStr;
        document.getElementById('resPrice').innerText = priceStr;
        document.getElementById('result').style.display = 'block';

        // 6. æº–å‚™åˆ†äº«æ–‡å­—
        finalResultText = 
`ã€å†·æ°£è©•ä¼°å ±å‘Šã€‘
ğŸ  ç©ºé–“ï¼š${ping.toFixed(1)}åª (${roomTypeName})
â˜€ï¸ æ¢ä»¶ï¼š${envText.join("ã€")}
â„ï¸ å»ºè­°ï¼š${modelStr}
ğŸ’° é ç®—ï¼š${priceStr}
${rebateStr ? rebateStr + "\n" : ""}(æ­¤ç‚ºç³»çµ±ä¼°ç®—ï¼Œåƒ…ä¾›åƒè€ƒ)`;
    }

    function copyToClipboard() {
        if (!finalResultText) return;
        navigator.clipboard.writeText(finalResultText).then(() => alert("âœ… çµæœå·²è¤‡è£½ï¼"));
    }

    function shareToLine() {
        if (!finalResultText) return;
        const url = `https://line.me/R/msg/text/?${encodeURIComponent(finalResultText)}`;
        window.open(url, '_blank');
    }
</script>

</body>
</html>

